(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/detail/detail"],{1654:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,i=(e._self._c,e.theme()||""),a=e.theme(),o=e.topBarHeight(),n=0!=o?e.topBarHeight():null,s=0!=o?e.topBarTop():null,c=e.topBarHeight(),u=0!=c?e.topBarHeight():null,r=e.loadding?null:e.topBarTop(),l=!e.loadding&&e.ispresale&&"advance"==e.activeName?e.subPrice(e.detail[e.activeName][e.skuName][0].product_price,"1"):null,d=!e.loadding&&e.ispresale&&"advance"==e.activeName?e.subPrice(e.detail[e.activeName][e.skuName][0].product_price,"2"):null,p=!e.loadding&&e.ispresale&&"advance"!=e.activeName?e.subPrice(e.detail[e.activeName][e.skuName][0][e.activePrice],"1"):null,h=!e.loadding&&e.ispresale&&"advance"!=e.activeName?e.subPrice(e.detail[e.activeName][e.skuName][0][e.activePrice],"2"):null,_=!e.loadding&&e.ispresale&&"advance"==e.activeName?(1*e.detail[e.activeName][e.skuName][0].product_price-1*e.detail[e.activeName][e.skuName][0][e.activePrice]).toFixed(2):null,v=!e.loadding&&e.ispresale?{startstamp:e.detail[e.activeName].start_time,endstamp:e.detail[e.activeName].end_time}:null,f=!e.loadding&&e.ispresale&&"advance"==e.activeName?(1*e.detail[e.activeName][e.skuName][0].product_price-1*e.detail[e.activeName][e.skuName][0][e.activePrice]).toFixed(2):null,m=!e.loadding&&e.show_discount&&e.discount.give_points>0?e.points_name():null,g=!e.loadding&&e.show_discount&&e.discount.give_points>0?e.points_name():null,w=!e.loadding&&e.show_discount&&e.discount.give_points>0?e.points_name():null,k=!e.loadding&&e.show_discount?e.discount.product_coupon.length:null,P=!e.loadding&&e.show_discount?e.discount.product_reduce.length:null;e._isMounted||(e.e0=function(t){e.isVideoPlay=!0},e.e1=function(t){e.isVideoPlay=!0},e.e2=function(t){e.isVideoPlay=!1},e.e3=function(t){e.isVideoPlay=!1}),e.$mp.data=Object.assign({},{$root:{m0:i,m1:a,m2:o,m3:n,m4:s,m5:c,m6:u,m7:r,m8:l,m9:d,m10:p,m11:h,g0:_,a0:v,g1:f,m12:m,m13:g,m14:w,g2:k,g3:P}})},o=[]},2780:function(e,t,i){"use strict";var a=i("40fb"),o=i.n(a);o.a},4091:function(e,t,i){"use strict";(function(e,t){var a=i("47a9");i("c163");a(i("3240"));var o=a(i("f5d3"));e.__webpack_require_UNI_MP_PLUGIN__=i,t(o.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},"40fb":function(e,t,i){},"67d6":function(e,t,i){"use strict";(function(e){var a=i("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("7ca3")),n=a(i("2bb2")),s={components:{spec:function(){i.e("pages/product/detail/popup/spec").then(function(){return resolve(i("cfde"))}.bind(null,i)).catch(i.oe)},share:function(){i.e("pages/product/detail/popup/share").then(function(){return resolve(i("fdfd"))}.bind(null,i)).catch(i.oe)},uniPopup:function(){i.e("components/uni-popup").then(function(){return resolve(i("f89c"))}.bind(null,i)).catch(i.oe)},Mpservice:function(){i.e("components/mpservice/Mpservice").then(function(){return resolve(i("0315"))}.bind(null,i)).catch(i.oe)},guarantee:function(){i.e("components/guarantee").then(function(){return resolve(i("3e5d"))}.bind(null,i)).catch(i.oe)},AppShare:function(){Promise.all([i.e("common/vendor"),i.e("components/app-share")]).then(function(){return resolve(i("3ca9"))}.bind(null,i)).catch(i.oe)},coupon:function(){i.e("pages/product/detail/popup/coupon").then(function(){return resolve(i("2b5a"))}.bind(null,i)).catch(i.oe)},Countdown:function(){i.e("components/countdown/countdown-presale").then(function(){return resolve(i("bbc5"))}.bind(null,i)).catch(i.oe)},previewProduct:function(){i.e("pages/product/detail/productinfo/previewProduct").then(function(){return resolve(i("6c1b"))}.bind(null,i)).catch(i.oe)}},data:function(){return{ispresale:!1,statusBarHeight:0,titleBarHeight:0,store_open:1,phoneHeight:0,scrollviewHigh:0,loadding:!0,indicatorDots:!0,autoplay:!1,interval:2e3,duration:500,isPopup:!1,product_id:null,detail:{product_sku:{},show_sku:{product_price:"",product_sku_id:0,line_price:"",stock_num:0,sku_image:""}},specData:null,productModel:{},buyNow:!1,url:"",productSpecArr:[],cart_total_num:0,isbottmpanel:!1,isguarantee:!1,isCreatedImg:!1,poster_img:"",isMpservice:!1,alreadyChioce:"",shop_info:"",isfollow:"",shop_supplier_id:"",serverList:"",room_id:"",isAppShare:!1,appParams:{title:"",summary:"",path:""},service_open:0,service_type:0,user_id:0,is_virtual:1,couponList:[],isCoupon:!1,middle:1,isVideoPlay:!1,show_discount:"",discount:{product_coupon:[],product_reduce:[],give_points:""},activeName:"",activePrice:"",activeText:"",skuName:"",is_preview:0,userInfo:{}}},onLoad:function(t){this.GetStatusBarHeight();var i=n.default.getSceneData(t);this.user_id=e.getStorageInfoSync("user_id"),this.room_id=t.room_id,this.product_id=t.product_id?t.product_id:i.gid},onReady:function(){this.init(),this.getData(),this.getDetail()},methods:{getDetail:function(){var e=this;e._get("user.index/detail",{},(function(t){e.userInfo=t.data.userInfo}))},GetStatusBarHeight:function(){var t=e.getSystemInfoSync();t.statusBarHeight;this.statusBarHeight=e.getMenuButtonBoundingClientRect().top,this.titleBarHeight=e.getMenuButtonBoundingClientRect().height},init:function(){var t=this;e.getSystemInfo({success:function(i){t.phoneHeight=i.windowHeight;var a=e.createSelectorQuery().select(".btns-wrap");a.boundingClientRect((function(e){var i=(t.phoneHeight,e.height);i=t.phoneHeight,t.scrollviewHigh=i})).exec()}})},getData:function(){var t=this,i=t.product_id;e.showLoading({title:"加载中"}),t._get("product.product/detail",{product_id:i,url:t.url,visitcode:t.getVisitcode()},(function(i){console.log(1==i.data.detail.is_preview&&(new Date).valueOf()/1e3<i.data.detail.preview_time),1==i.data.detail.is_preview&&(new Date).valueOf()/1e3<i.data.detail.preview_time?(t.is_preview=i.data.detail.is_preview,t.activeText="预告",t.activeName="preview",t.activePrice="preview_price",i.data.detail.preview={start_time:(new Date).valueOf()/1e3,end_time:i.data.detail.preview_time}):i.data.detail.advance&&null!=i.data.detail.advance?(t.ispresale=!0,t.activeName="advance",t.activeText="预售",t.activePrice="advance_price",t.skuName="sku"):i.data.detail.secKill&&null!=i.data.detail.secKill&&(t.ispresale=!0,t.activeName="secKill",t.activeText="秒杀",t.activePrice="seckill_price",t.skuName="seckillSku",i.data.detail.secKill.start_time=i.data.detail.secKill.active.start_time,i.data.detail.secKill.end_time=i.data.detail.secKill.active.end_time),t.shop_supplier_id=i.data.detail.supplier.shop_supplier_id,t.shop_info=i.data.detail.supplier,t.isfollow=i.data.detail.isfollow,t.service_open=i.data.service_open,t.is_virtual=i.data.detail.is_virtual,t.couponList=i.data.couponList,null==i.data.mp_service?t.service_type=10:t.service_type=i.data.mp_service.service_type,t.cart_total_num=i.data.cart_total_num,t.store_open=i.data.store_open,i.data.detail.content=n.default.format_content(i.data.detail.content),t.activeName&&"advance"!=t.activeName?i.data.detail[t.activeName].specData&&t.initSpecData(i.data.detail[t.activeName].specData):20==i.data.detail.spec_type&&t.initSpecData(i.data.specData),t.detail=i.data.detail,t.show_discount=i.data.show_discount,t.discount=i.data.discount,t.getServer(),t.loadding=!1,e.hideLoading()}))},getServer:function(){var e=[];this.detail.server.forEach((function(t,i){e.push(t.name)})),this.serverList=e.join("·")},initSpecData:function(e){var t=this;for(var i in e.spec_attr)for(var a in e.spec_attr[i].spec_items)e.spec_attr[i].spec_items[a].checked=!1;this.specData=e,this.specData.spec_attr&&(this.specData.spec_attr.forEach((function(e){t.alreadyChioce+=e.group_name,t.alreadyChioce+=" / "})),this.alreadyChioce=this.alreadyChioce.replace(/(\s\/\s)$/gi,""))},openPopup:function(e){var t,i={specData:this.specData,detail:this.detail,productSpecArr:null!=this.specData?new Array(this.specData.spec_attr.length):[],show_sku:(t={sku_image:"",price:0,product_sku_id:0,line_price:0,stock:0},(0,o.default)(t,"product_sku_id",0),(0,o.default)(t,"sum",1),t),plus_sku:null,type:e,plus_name:""};"advance"==this.activeName&&(i.plus_sku=this.detail.advance.sku,i.plus_name="advance"),"secKill"==this.activeName&&(i.plus_sku=this.detail.secKill.seckillSku,i.plus_name="seckill"),this.productModel=i,this.isPopup=!0},closePopup:function(e,t){if(this.isPopup=!1,e&&e.spec_attr){this.alreadyChioce="";var i="已选：",a="";e.spec_attr.forEach((function(e){if(e.spec_items){for(var t="",o=0;o<e.spec_items.length;o++){var n=e.spec_items[o];if(n.checked){t=n.spec_value+" / ";break}}""!=t?i+=t:a+=e.group_name}})),""!=a?this.alreadyChioce=a:(i=i.replace(/(\s\/\s)$/gi,""),this.alreadyChioce=i)}t&&(this.cart_total_num=t)},lookEvaluate:function(e){this.gotoPage("/pages/product/detail/look-evaluate/look-evaluate?product_id="+e)},onShareAppMessage:function(){this.taskFunc();var e=this.getShareUrlParams({product_id:this.product_id});return{title:this.detail.product_name,path:"/pages/product/detail/detail?"+e}},goback:function(){var t=getCurrentPages();console.log(t.length),t.length<=1?this.gotoPage("/pages/index/index"):e.navigateBack()},gotocart:function(){this.gotoPage("/pages/cart/cart")},closeBottmpanel:function(e){this.isbottmpanel=!1,2==e.type&&(this.poster_img=e.poster_img,this.isCreatedImg=!0)},closeGuarantee:function(){this.isguarantee=!1},showGuarantee:function(){this.isguarantee=!0},showShare:function(){this.isbottmpanel=!0,this.taskFunc()},closeAppShare:function(e){this.isAppShare=!1},hidePopupFunc:function(){this.isCreatedImg=!1},savePosterImg:function(){var t=this;e.showLoading({title:"加载中"}),e.downloadFile({url:t.poster_img,success:function(i){e.hideLoading(),e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(i){e.showToast({title:"保存成功",icon:"success",duration:2e3}),t.isCreatedImg=!1},fail:function(t){"saveImageToPhotosAlbum:fail auth deny"===t.errMsg&&(e.showToast({title:"请允许访问相册后重试",icon:"none",duration:1e3}),setTimeout((function(){e.openSetting()}),1e3))},complete:function(e){console.log("complete")}})}})},openCoupon:function(){this.isCoupon=!this.isCoupon},openService:function(){10==this.service_type&&(this.isMpservice=!0),20==this.service_type&&this.gotoPage("/pages/plus/chat/chat?user_id="+this.shop_info.supplier_user_id+"&product_id="+this.product_id+"&shop_supplier_id="+this.shop_info.shop_supplier_id+"&nickName="+this.shop_info.name)},closeMpservice:function(){this.isMpservice=!1},closeCouponFunc:function(e){this.isCoupon=!1},goto_shop:function(){this.gotoPage("/pages/shop/shop?shop_supplier_id="+this.shop_supplier_id)},favorite:function(){var t=this;t._post("user.Favorite/add",{pid:t.product_id,type:20},(function(i){0==t.isfollow?(e.showToast({icon:"none",title:"收藏成功，请到“我的->我的收藏”查看和管理哦"}),t.isfollow=1):1==t.isfollow&&(t.isfollow=0,e.showToast({icon:"none",title:"取消成功"}))}))},changeSwiper:function(){this.isVideoPlay=!1},returnValFunc:function(e){},taskFunc:function(){this._post("plus.task.Task/dayTask",{task_type:"product",referee_id:this.userInfo.referee_id},(function(e){console.log("分享成功")}))},sendFunc:function(e){this[e]()}}};t.default=s}).call(this,i("df3c")["default"])},7439:function(e,t,i){"use strict";i.r(t);var a=i("67d6"),o=i.n(a);for(var n in a)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(n);t["default"]=o.a},f5d3:function(e,t,i){"use strict";i.r(t);var a=i("1654"),o=i("7439");for(var n in o)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(n);i("2780");var s=i("828b"),c=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=c.exports}},[["4091","common/runtime","common/vendor"]]]);