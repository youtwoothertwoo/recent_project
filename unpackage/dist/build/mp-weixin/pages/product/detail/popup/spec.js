(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/detail/popup/spec"],{"0789":function(s,o,t){"use strict";t.d(o,"b",(function(){return i})),t.d(o,"c",(function(){return r})),t.d(o,"a",(function(){}));var i=function(){var s=this.$createElement;this._self._c},r=[]},"07a5":function(s,o,t){"use strict";(function(s){var i=t("47a9");Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var r=i(t("3b2d")),e={data:function(){return{Visible:!1,form:{detail:{},show_sku:{sku_image:""}},stock:0,selectSpec:"",isOpenSpec:!1,type:"",clock:!1}},props:["isPopup","productModel","room_id"],onLoad:function(){},mounted:function(){},computed:{isadd:function(){return this.form.show_sku.sum>=this.stock||this.form.show_sku.sum>=this.form.detail.limit_num},issub:function(){return this.form.show_sku.sum<=1}},watch:{isPopup:function(s,o){s!=o&&(this.Visible=s,this.isOpenSpec||(this.form=this.productModel,this.isOpenSpec=!0,this.initShowSku()),this.form.type=this.productModel.type)},"form.specData":{handler:function(s,o){var t=this,i="",r="";if(this.isAll=!0,s){for(var e=function(o){null==t.form.productSpecArr[o]?(t.isAll=!1,i+=s.spec_attr[o].group_name+" "):s.spec_attr[o].spec_items.forEach((function(s){t.form.productSpecArr[o]==s.item_id&&(r+='"'+s.spec_value+'" ')}))},u=0;u<s.spec_attr.length;u++)e(u);this.isAll?r="已选: "+r:i="请选择: "+i}this.selectSpec=this.isAll?r:i},deep:!0,immediate:!0}},methods:{initShowSku:function(){this.form.show_sku.sku_image=this.form.detail.image[0].file_path,this.form.show_sku.product_price=this.form.detail.product_price,20==this.form.detail.spec_type&&this.form.detail.product_price!=this.form.detail.product_max_price&&(this.form.show_sku.product_price=this.form.detail.product_price+"-"+this.form.detail.product_max_price),this.form.show_sku.spec_sku_id=0,this.form.show_sku.line_price=this.form.detail.line_price,this.form.show_sku.stock_num=this.form.detail.product_stock,this.form.show_sku.sum=1,this.stock=this.form.detail.product_stock,"advance"==this.form.plus_name&&(this.form.show_sku.product_price=this.form.plus_sku[0].product_price,this.form.show_sku.line_price="",this.form.show_sku.sku_image=this.form.plus_sku[0].productSku.image?this.form.plus_sku[0].productSku.image.file_path:this.form.detail.image[0].file_path,this.form.show_sku.stock_num=this.form.plus_sku[0].advance_stock,this.stock=this.form.plus_sku[0].advance_stock),"seckill"==this.form.plus_name&&(this.form.show_sku.product_price=this.form.plus_sku[0].seckill_price,this.form.show_sku.line_price=this.form.plus_sku[0].product_price,this.form.show_sku.sku_image=this.form.plus_sku[0].productSku.image?this.form.plus_sku[0].productSku.image.file_path:this.form.detail.image[0].file_path,this.form.show_sku.stock_num=this.form.plus_sku[0].seckill_stock,this.stock=this.form.plus_sku[0].seckill_stock)},selectAttr:function(s,o){var t=this.form.specData.spec_attr[s].spec_items,i=t[o];if(i.checked)i.checked=!1,this.form.productSpecArr[s]=null;else{for(var r=0;r<t.length;r++)t[r].checked=!1;i.checked=!0,this.form.productSpecArr[s]=i.item_id}for(var e=0;e<this.form.productSpecArr.length;e++)if(null==this.form.productSpecArr[e])return void this.initShowSku();this.updateSpecProduct()},updateSpecProduct:function(){var s=this,o=s.form.productSpecArr.join("_"),t=s.form.specData.spec_list;null!=s.form.plus_sku&&(t=s.form.plus_sku);var i=t.find((function(t){return s.form.plus_name?t.productSku.spec_sku_id==o:t.spec_sku_id==o}));if(!i)return s.clock=!0,void s.initShowSku();s.clock=!1,s.form.plus_name&&!i.spec_form&&(i.spec_form=i.productSku),"object"===(0,r.default)(i)&&(s.form.plus_name?(s.stock=i[s.form.plus_name+"_stock"],s.form.show_sku.sum>s.stock&&(s.form.show_sku.sum=s.stock>0?s.stock:1)):(s.stock=i.spec_form.stock_num,s.form.show_sku.sum>s.stock&&(s.form.show_sku.sum=s.stock>0?s.stock:1)),s.form.show_sku.spec_sku_id=o,s.form.show_sku.product_price=i.spec_form.product_price,s.form.show_sku.line_price=i.spec_form.line_price,i.spec_form.image_id>0?s.form.show_sku.sku_image=i.spec_form.image_path:s.form.show_sku.sku_image=s.form.detail.image[0].file_path,s.form.show_sku.stock_num=i.spec_form.stock_num,s.form.plus_name&&(s.form.show_sku.product_price=i.product_price,"seckill"==s.form.plus_name&&(s.form.show_sku.product_price=i.seckill_price),s.form.show_sku.stock_num=i[s.form.plus_name+"_stock"],s.form.show_sku.line_price="",s.form.show_sku.sku_image=i.spec_form.image?i.spec_form.image.file_path:s.form.detail.image[0].file_path,s.form.show_sku.advance_product_id=i.spec_form.image?i.spec_form.image.file_path:s.form.detail.image[0].file_path))},closePopup:function(){this.$emit("close",this.form.specData,null)},confirmFunc:function(){if(null!=this.form.specData)for(var o=0;o<this.form.productSpecArr.length;o++)if(null==this.form.productSpecArr[o])return void s.showToast({title:"请选择规格",icon:"none",duration:2e3});"card"==this.form.type?this.addCart():this.createdOrder()},addCart:function(){var o=this,t=o.form.detail.product_id,i=o.form.show_sku.sum,r=o.form.show_sku.spec_sku_id;if(20==o.form.detail.spec_type&&0==r)return s.showToast({title:"请选择属性",icon:"none",duration:2e3}),!1;o._post("order.cart/add",{product_id:t,total_num:i,spec_sku_id:r},(function(t){s.showToast({title:t.msg,duration:2e3}),o.$emit("close",null,t.data.cart_total_num)}))},createdOrder:function(){var s=this.form.detail.product_id,o=this.form.show_sku.sum,t=this.form.show_sku.spec_sku_id,i="";0!=this.room_id&""!=this.room_id&&(i="&room_id="+this.room_id),console.log(i);var r="/pages/order/confirm-order?product_id="+s+"&product_num="+o+"&product_sku_id="+t+"&order_type=buy"+i;if("deposit"==this.form.type){if("advance"==this.form.plus_name){var e=this.form.detail.advance.sku.find((function(s){return s.productSku.spec_sku_id==t}));r="/pages/order/confirm-order?product_id="+s+"&product_num="+o+"&product_sku_id="+t+"&advance_product_sku_id="+e.advance_product_sku_id+"&advance_product_id="+e.advance_product_id+"&order_type=deposit"}if("seckill"==this.form.plus_name){var u=this.form.detail.secKill.seckillSku.find((function(s){return s.productSku.spec_sku_id==t}));r="/pages/order/confirm-order?seckill_product_id="+u.seckill_product_id+"&product_num="+o+"&product_sku_id="+u.productSku.spec_sku_id+"&seckill_product_sku_id="+u.seckill_product_sku_id+"&order_type=seckill"}}this.gotoPage(r)},add:function(){if(!(this.stock<=0))return this.form.show_sku.sum>=this.stock?(s.showToast({title:"数量超过了库存",icon:"none",duration:2e3}),!1):this.form.detail.limit_num>0&&this.form.show_sku.sum>=this.form.detail.limit_num?(s.showToast({title:"数量超过了限购数量",icon:"none",duration:2e3}),!1):void this.form.show_sku.sum++},sub:function(){if(!(this.stock<=0))return this.form.show_sku.sum<2?(s.showToast({title:"商品数量至少为1",icon:"none",duration:2e3}),!1):void this.form.show_sku.sum--}}};o.default=e}).call(this,t("df3c")["default"])},"4a76":function(s,o,t){},b781:function(s,o,t){"use strict";t.r(o);var i=t("07a5"),r=t.n(i);for(var e in i)["default"].indexOf(e)<0&&function(s){t.d(o,s,(function(){return i[s]}))}(e);o["default"]=r.a},c82a:function(s,o,t){"use strict";var i=t("4a76"),r=t.n(i);r.a},cfde:function(s,o,t){"use strict";t.r(o);var i=t("0789"),r=t("b781");for(var e in r)["default"].indexOf(e)<0&&function(s){t.d(o,s,(function(){return r[s]}))}(e);t("c82a");var u=t("828b"),c=Object(u["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);o["default"]=c.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/product/detail/popup/spec-create-component',
    {
        'pages/product/detail/popup/spec-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('df3c')['createComponent'](__webpack_require__("cfde"))
        })
    },
    [['pages/product/detail/popup/spec-create-component']]
]);
