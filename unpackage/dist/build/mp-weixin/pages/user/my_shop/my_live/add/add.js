(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/my_shop/my_live/add/add"],{"198e":function(t,e,i){"use strict";var n=i("906a"),o=i.n(n);o.a},"37e0":function(t,e,i){"use strict";i.r(e);var n=i("eebe"),o=i("579b");for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);var c=i("828b"),s=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=s.exports},"579b":function(t,e,i){"use strict";i.r(e);var n=i("afda"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},"64e9":function(t,e,i){"use strict";(function(t,e){var n=i("47a9");i("c163");n(i("3240"));var o=n(i("ddca"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},"906a":function(t,e,i){},a90e:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){}));var n=function(){var t=this.$createElement;this._self._c},o=[]},afda:function(t,e,i){"use strict";(function(t){var n=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(i("3b2d")),a={data:function(){return{imageList:[]}},props:["num","isVideo"],onLoad:function(){},mounted:function(){this.chooseImageFunc()},methods:{chooseImageFunc:function(){var e=this;this.isVideo?t.chooseVideo({maxDuration:60,camera:"back",success:function(t){if(console.log(t),t){var i=[];i.push(t.tempFilePath),console.log(i),e.uploadFile(i)}},fail:function(t){console.log(t),e.$emit("getImgs",null)}}):t.chooseImage({count:e.num||9,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){e.uploadFile(t.tempFilePaths)},fail:function(t){e.$emit("getImgs",null)},complete:function(t){}})},uploadFile:function(e){var i=this,n=0,a=e.length,c={token:t.getStorageSync("token"),app_id:i.getAppId(),file_type:i.isVideo?"video":"image"};t.showLoading({title:"上传中"}),e.forEach((function(e,s){t.uploadFile({url:i.websiteUrl+"/index.php?s=/api/file.upload/image",filePath:e,name:"iFile",formData:c,success:function(t){var e="object"===(0,o.default)(t.data)?t.data:JSON.parse(t.data);if(-1===e.code)return console.log("登录态失效, 重新登录"),void i.doLogin();1===e.code&&i.imageList.push(e.data)},complete:function(){n++,a===n&&(t.hideLoading(),i.$emit("getImgs",i.imageList))}})}))}}};e.default=a}).call(this,i("df3c")["default"])},b220:function(t,e,i){"use strict";(function(t,n){var o=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(i("37e0")),c={components:{Upload:a.default,pickerViewDatetime:function(){i.e("components/picker-view-datetime/pickerViewDatetime").then(function(){return resolve(i("b76d"))}.bind(null,i)).catch(i.oe)},Products:function(){i.e("pages/user/my_shop/my_live/add/dialog/Products").then(function(){return resolve(i("efd4"))}.bind(null,i)).catch(i.oe)}},data:function(){return{phoneHeight:0,scrollviewHigh:0,loading:!0,form:{name:"",share_img_id:null,share_img_path:"",start_time:"",end_time:"",productIds:[],category_id:0},isUpload:!1,file_type:null,cur_image:null,open_products:!1,relationList:[],categorylist:[],category:"",categorytype:[],index:0}},computed:{},onLoad:function(){},mounted:function(){this.init()},methods:{init:function(){var e=this;t.getSystemInfo({success:function(i){e.phoneHeight=i.windowHeight;var n=t.createSelectorQuery().select(".foot-btns");n.boundingClientRect((function(t){var i=e.phoneHeight-t.height;e.scrollviewHigh=i})).exec()}})},getCategory:function(){var t=this;t._post("plus.live.RoomApply/category",{},(function(e){e.data.list.forEach((function(e,i){t.categorylist.push(e.name)})),t.categorytype=e.data.list}))},showProducts:function(){this.open_products=!0},closeProducts:function(t){this.open_products=!1,this.relationList=t},formSubmit:function(e){""!=this.form.name?/[<>*{}()^%$#@!~&= ]/.test(this.form.name)?n.showModal({title:"提示",content:"标题不能为空或包含特殊字符",showCancel:!1}):new Date(this.form.start_time).getTime()>=new Date(this.form.end_time).getTime()?n.showModal({title:"提示",content:"开始时间不能大于结束时间",showCancel:!1}):null!=this.form.share_img_id?(console.log(this.relationList),this.form.productIds=this.relationList,this._post("plus.live.RoomApply/addnotice",this.form,(function(e){t.showToast({title:"创建成功"}),t.navigateBack({delta:1})}))):n.showModal({title:"提示",content:"请上传封面图",showCancel:!1}):n.showModal({title:"提示",content:"请输入标题",showCancel:!1})},getStartTime:function(t){this.form.start_time=t+":00"},getStartEnd:function(t){this.form.end_time=t+":59"},openUpload:function(t){this.cur_imagetype=t,this.file_type="image",this.isUpload=!0},getImgsFunc:function(t){t&&"undefined"!=typeof t&&null!=this.cur_imagetype&&(this.form[this.cur_imagetype+"id"]=t[0]["file_id"],this.form[this.cur_imagetype+"path"]=t[0]["file_path"],this.cur_imagetype=null),this.isUpload=!1},bindPickerChange:function(t){this.index=t.target.value,this.category=this.categorylist[this.index],this.form.category_id=this.categorytype[this.index].category_id}}};e.default=c}).call(this,i("df3c")["default"],i("3223")["default"])},b3d4:function(t,e,i){"use strict";i.r(e);var n=i("b220"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},ddca:function(t,e,i){"use strict";i.r(e);var n=i("a90e"),o=i("b3d4");for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);i("198e");var c=i("828b"),s=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,"0a06233c",null,!1,n["a"],void 0);e["default"]=s.exports},eebe:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){}));var n=function(){var t=this.$createElement;this._self._c},o=[]}},[["64e9","common/runtime","common/vendor"]]]);