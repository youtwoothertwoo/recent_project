(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/set/set"],{"03ae":function(e,n,t){},"3d50":function(e,n,t){"use strict";(function(e){var i=t("47a9");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(t("3b2d")),s={components:{Upload:function(){t.e("components/upload/uploadOne").then(function(){return resolve(t("79e4"))}.bind(null,t)).catch(t.oe)},Popup:function(){t.e("components/uni-popup").then(function(){return resolve(t("f89c"))}.bind(null,t)).catch(t.oe)}},data:function(){return{userInfo:{},isUpload:!1,isPopup:!1,isOpen:!1,isShow:!1,newName:"",newPsd:"",oldPsd:"",confirmPsd:"",hdPsd:"",type:"",version_no:"",imageList:[],max_length:6}},onShow:function(){this.getData()},methods:{onChooseAvatar:function(e){console.log(e),this.uploadFile([e.detail.avatarUrl])},getData:function(){var n=this;e.showLoading({title:"加载中"}),n._get("user.index/setting",{},(function(t){n.userInfo=t.data.userInfo,e.hideLoading()}))},gotoBind:function(){this.gotoPage("/pages/user/modify-phone/modify-phone")},logout:function(){e.removeStorageSync("token"),e.removeStorageSync("user_id"),this.gotoPage("/pages/index/index")},changeName:function(e){"mobile"==e&&(this.oldmobile=this.userInfo.mobile),this.type=e,this.newName=this.userInfo[e],this.isPopup=!0},hidePopupFunc:function(){this.newName="",this.isShow=!1},changeinput:function(e){this.newName=e.target.value},clearName:function(){this.newName=""},clearPsd:function(){this.newPsd=""},clearHdPsd:function(){this.hdPsd=""},subName:function(e){this.loading||(this.newName=e.detail.value.newName,this.userInfo[this.type]=this.newName,this.update())},changeAvatarUrl:function(){this.isUpload=!0},uploadFile:function(n){var t=this,i=0,s=n.length,a={token:e.getStorageSync("token"),app_id:t.getAppId()};e.showLoading({title:"图片上传中"}),n.forEach((function(n,u){e.uploadFile({url:t.websiteUrl+"/index.php?s=/api/file.upload/image",filePath:n,name:"iFile",formData:a,success:function(e){var n="object"===(0,o.default)(e.data)?e.data:JSON.parse(e.data);1===n.code?t.imageList.push(n.data):t.showError(n.msg)},complete:function(){i++,s===i&&(e.hideLoading(),t.getImgsFunc(t.imageList))}})}))},getImgsFunc:function(e){if(e&&"undefined"!=typeof e){this.userInfo.avatarUrl=e[0].file_path,this.update(),this.isUpload=!1}},update:function(){var n=this;if(!n.loading){e.showLoading({title:"加载中"});var t=n.userInfo;n.loading=!0,n._post("user.user/updateInfo",t,(function(t){n.showSuccess("修改成功",(function(){n.loading=!1,n.isPopup=!1,e.hideLoading(),n.getData()}),(function(t){e.hideLoading(),n.loading=!1,n.isPopup=!1}))}))}},deleteAccount:function(){var n=this;e.showModal({title:"提示",content:"是否确认删除账号？删除后您将无法用此账号登录，此账户下的数据也将删除",success:function(t){t.confirm&&n._post("user.user/deleteAccount",{},(function(t){n.showSuccess("删除成功",(function(){e.removeStorageSync("token"),e.removeStorageSync("user_id"),n.gotoPage("/pages/index/index")}))}),!1,(function(){e.hideLoading()}))}})},setpass:function(){this.isOpen=!0},hedui:function(){this.isShow=!0},handleClose:function(){this.newPsd="",this.oldPsd="",this.confirmPsd="",this.isOpen=!1},heduiClose:function(){this.hdPsd="",this.isShow=!1},changePsd:function(e){this.newPsd=e.detail.value},changeOldPsd:function(e){this.oldPsd=e.detail.value},changeConfirmPsd:function(e){this.confirmPsd=e.detail.value},heduiPsd:function(e){this.hdPsd=e.detail.value},getPrevRoute:function(){var e=getCurrentPages();if(e.length<2)return null;var n=e[e.length-2];return{route:n.route||n.__route__,options:n.options||{}}},subPsd:function(){var n=this;if(""!=n.newPsd)if(n.newPsd.length<n.max_length)n.showError("请输入"+n.max_length+"位密码");else if(n.newPsd==n.confirmPsd)if(e.showLoading({title:"加载中"}),0===this.userInfo.pay_password_status){var t={pay_password:this.newPsd};n._post("user.user/setPayPassword",t,(function(t){n.showSuccess("设置成功",(function(){n.loading=!1,n.isOpen=!1,e.hideLoading(),n.userInfo.pay_password_status=1,n.getData();var t=n.getPrevRoute();t&&"pages/order/cashier"===t.route&&e.navigateBack()}),(function(t){e.hideLoading(),n.loading=!1,n.isPopup=!1}))}))}else{var i={pay_password_new:this.newPsd,pay_password_old:this.oldPsd};n._post("user.user/updatePayPassword",i,(function(t){n.showSuccess("修改成功",(function(){n.loading=!1,n.isOpen=!1,e.hideLoading(),n.getData()}),(function(t){e.hideLoading(),n.loading=!1,n.isOpen=!1}))}))}else n.showError("两次输入的密码不一致");else n.showError("请输入密码")}}};n.default=s}).call(this,t("df3c")["default"])},6445:function(e,n,t){"use strict";t.r(n);var i=t("9a99"),o=t("688c");for(var s in o)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(s);t("a450");var a=t("828b"),u=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);n["default"]=u.exports},"688c":function(e,n,t){"use strict";t.r(n);var i=t("3d50"),o=t.n(i);for(var s in i)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(s);n["default"]=o.a},"9a99":function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return o})),t.d(n,"a",(function(){}));var i=function(){var e=this.$createElement,n=(this._self._c,this.theme()||""),t=this.theme();this.$mp.data=Object.assign({},{$root:{m0:n,m1:t}})},o=[]},a450:function(e,n,t){"use strict";var i=t("03ae"),o=t.n(i);o.a},bdf1:function(e,n,t){"use strict";(function(e,n){var i=t("47a9");t("c163");i(t("3240"));var o=i(t("6445"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(o.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])}},[["bdf1","common/runtime","common/vendor"]]]);