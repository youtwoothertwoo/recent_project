(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/confirm-order","components/uni-popup"],{"0251":function(t,o,i){"use strict";(function(t,o){var e=i("47a9");i("112d");e(i("3240"));var r=e(i("4c7a"));t.__webpack_require_UNI_MP_PLUGIN__=i,o(r.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},"224d":function(t,o,i){},"4c7a":function(t,o,i){"use strict";i.r(o);var e=i("7fc9"),r=i("ca3b");for(var n in r)["default"].indexOf(n)<0&&function(t){i.d(o,t,(function(){return r[t]}))}(n);i("db3f");var s=i("828b"),d=Object(s["a"])(r["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],void 0);o["default"]=d.exports},"570d":function(t,o,i){"use strict";i.r(o);var e=i("88ca"),r=i.n(e);for(var n in e)["default"].indexOf(n)<0&&function(t){i.d(o,t,(function(){return e[t]}))}(n);o["default"]=r.a},"599d":function(t,o,i){"use strict";i.d(o,"b",(function(){return e})),i.d(o,"c",(function(){return r})),i.d(o,"a",(function(){}));var e=function(){var t=this.$createElement;this._self._c},r=[]},"7fc9":function(t,o,i){"use strict";i.d(o,"b",(function(){return e})),i.d(o,"c",(function(){return r})),i.d(o,"a",(function(){}));var e=function(){var t=this,o=t.$createElement,i=(t._self._c,t.loading?null:t.theme()||""),e=t.loading?null:t.theme(),r=t.loading?null:t.__map(t.ProductData,(function(o,i){var e=t.__get_orig(o),r="deposit"==t.options.order_type||t.OrderData.force_points?null:t.objKeys(o.orderData.couponList,1),n="deposit"==t.options.order_type||t.OrderData.force_points||!(r>0)||o.orderData.coupon_money>0?null:t.objKeys(o.orderData.couponList,1),s="deposit"!=t.options.order_type&&1==t.is_use_points&&!t.OrderData.force_points&&o.orderData.points_money>0?t.points_name():null,d="deposit"!=t.options.order_type?o.productList.length:null,a="deposit"==t.options.order_type||t.OrderData.force_points?null:t.toDecimal2(o.orderData.order_pay_price);return{$orig:e,m2:r,m3:n,m4:s,g0:d,m5:a}})),n=!t.loading&&"deposit"!=t.options.order_type&&t.OrderData.is_allow_points&&0==t.OrderData.force_points&&0!=t.OrderData.points_money?t.points_name():null,s=!t.loading&&"deposit"!=t.options.order_type&&t.OrderData.is_allow_points&&0==t.OrderData.force_points&&0!=t.OrderData.points_money?t.toDecimal2(t.OrderData.points_money):null,d=!t.loading&&"deposit"!=t.options.order_type&&t.OrderData.force_points?t.points_name():null;t.$mp.data=Object.assign({},{$root:{m0:i,m1:e,l0:r,m6:n,m7:s,m8:d}})},r=[]},"88ca":function(t,o,i){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var e={props:{show:{type:Boolean,default:!1},type:{type:String,default:"middle"},width:{type:Number,default:600},heigth:{type:Number,default:800},padding:{type:Number,default:30},backgroundColor:{type:String,default:"#ffffff"},boxShadow:{type:String,default:"0 0 30upx rgba(0, 0, 0, .1)"},msg:{type:String,default:""}},data:function(){return{offsetTop:0}},methods:{hide:function(){this.$emit("hidePopup")}}};o.default=e},"8a41":function(t,o,i){"use strict";var e=i("224d"),r=i.n(e);r.a},a21a:function(t,o,i){"use strict";i.r(o);var e=i("599d"),r=i("570d");for(var n in r)["default"].indexOf(n)<0&&function(t){i.d(o,t,(function(){return r[t]}))}(n);i("8a41");var s=i("828b"),d=Object(s["a"])(r["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],void 0);o["default"]=d.exports},bfc4:function(t,o,i){},ca3b:function(t,o,i){"use strict";i.r(o);var e=i("cd6f"),r=i.n(e);for(var n in e)["default"].indexOf(n)<0&&function(t){i.d(o,t,(function(){return e[t]}))}(n);o["default"]=r.a},cd6f:function(t,o,i){"use strict";(function(t){var e=i("47a9");Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var r=e(i("7ca3"));e(i("a21a")),i("b68c");function n(t,o){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);o&&(e=e.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),i.push.apply(i,e)}return i}function s(t){for(var o=1;o<arguments.length;o++){var i=null!=arguments[o]?arguments[o]:{};o%2?n(Object(i),!0).forEach((function(o){(0,r.default)(t,o,i[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(i,o))}))}return t}var d={components:{Myinfo:function(){i.e("pages/order/confirm-order/my-info").then(function(){return resolve(i("5956"))}.bind(null,i)).catch(i.oe)},Coupon:function(){i.e("pages/order/confirm-order/coupon").then(function(){return resolve(i("9d32"))}.bind(null,i)).catch(i.oe)},Dist:function(){i.e("pages/order/confirm-order/distr").then(function(){return resolve(i("52b8"))}.bind(null,i)).catch(i.oe)}},data:function(){return{loading:!0,options:{},indicatorDots:!0,autoplay:!0,interval:2e3,duration:500,product_id:"",product_num:"",ProductData:[],OrderData:[],exist_address:!1,Address:{region:[]},extract_store:[],last_extract:{},product_sku_id:0,delivery:10,store_id:0,coupon_id:-1,is_use_points:1,remark:"",pay_type:20,isCoupon:!1,coupon_list:{},couponList:[],coupon_num:0,isDist:!1,temlIds:[],product_couponid:0,chooseSotr:0,deliverySetting:[],choose_delivery:10,store_data:{},choose_store_id:0,store_list:{},room_id:"",showAlipay:!1,balance:"",store_open:1,userInfo:{}}},onLoad:function(t){var o=this;o.options=t,o.room_id=t.room_id?t.room_id:0,console.log(o.room_id),o.$fire.on("selectStoreId",(function(t){o.extract_store=t,o.choose_store_id=t.store_id})),o.$fire.on("checkedfir",(function(t){o.choose_delivery=t})),this.getData1()},onShow:function(){this.getData()},mounted:function(){},methods:{getData1:function(){var o=this;t.showLoading({title:"加载中"}),o._get("user.index/setting",{},(function(i){o.userInfo=i.data.userInfo,t.hideLoading()}))},init:function(){var t="",o="",i=this;i.ProductData.forEach((function(e,n){t=e.shop_supplier_id,o={coupon_id:e.orderData.coupon_id,delivery:e.orderData.delivery,store_id:0,remark:""},i.store_data=s(s({},i.store_data),{},(0,r.default)({},t,o))}))},hasType:function(t){return-1!=this.deliverySetting.indexOf(t)},payTypeFunc:function(t){this.pay_type=t},onShowPoints:function(t){1==t.target.value?this.is_use_points=1:this.is_use_points=0,this.getData()},onTogglePopupCoupon:function(t,o){this.chooseSotr=0!=o?o.shop_supplier_id:0,this.isCoupon=!0,this.couponList=t},closeCouponFunc:function(t){if(t&&"number"!=typeof t)this.isCoupon=!1;else{if(0!=this.chooseSotr){var o=this.chooseSotr;this.store_data[o].coupon_id=t>0?t:0,this.chooseSotr=0}else this.coupon_id=t>0?t:0;this.isCoupon=!1,this.getData()}},getData:function(){var o=this;t.showLoading({title:"加载中"});var i=function(t){o.OrderData=t.data.orderInfo.orderData,o.temlIds=t.data.template_arr,o.ProductData=t.data.orderInfo.supplierList,o.exist_address=o.OrderData.exist_address,o.Address=o.OrderData.address,o.last_extract=o.OrderData.last_extract,"deposit"!=o.options.order_type&&(o.coupon_list=o.OrderData.coupon_list,o.coupon_id=o.OrderData.coupon_id_sys,o.coupon_num=Object.keys(o.coupon_list).length),o.balance=t.data.balance,o.store_open=t.data.store_open,0==o.OrderData.order_pay_price&&(o.pay_type=10),"{}"==JSON.stringify(o.store_data)&&o.init(),t.data.show_alipay&&(o.showAlipay=!0),o.loading=!1},e={delivery:o.delivery,store_id:o.store_id,coupon_id:o.coupon_id,is_use_points:o.is_use_points,pay_source:"android"};if(e="{}"==JSON.stringify(o.store_data)?e:s(s({},e),{},{supplier:o.store_data}),"buy"===o.options.order_type)o._get("order.order/buy",{params:JSON.stringify(Object.assign({},e,{product_id:o.options.product_id,product_num:o.options.product_num,product_sku_id:o.options.product_sku_id}))},(function(t){i(t)}),(function(o){t.navigateBack()}));else if("deposit"===o.options.order_type){var r=Object.assign({},e,{product_id:o.options.product_id,product_num:o.options.product_num,product_sku_id:o.options.product_sku_id,advance_product_sku_id:o.options.advance_product_sku_id,advance_product_id:o.options.advance_product_id});console.log(r),o._get("plus.advance.Order/frontBuy",{params:JSON.stringify(Object.assign({},e,{product_id:o.options.product_id,product_num:o.options.product_num,product_sku_id:o.options.product_sku_id,advance_product_sku_id:o.options.advance_product_sku_id,advance_product_id:o.options.advance_product_id}))},(function(t){i(t)}),(function(o){t.navigateBack()}))}else"retainage"===o.options.order_type?o._get("plus.advance.Order/buy",{params:JSON.stringify(Object.assign({},e,{order_id:o.options.order_id}))},(function(t){i(t)}),(function(o){t.navigateBack()})):"cart"===o.options.order_type?o._get("order.order/cart",{params:JSON.stringify(Object.assign({},e,{cart_ids:o.options.cart_ids||0}))},(function(t){i(t)}),(function(o){t.navigateBack()})):"points"==o.options.order_type?(console.log(o.options),o._get("plus.points.order/buy",{params:JSON.stringify(Object.assign({},e,{point_product_id:o.options.point_product_id,product_sku_id:o.options.product_sku_id,point_product_sku_id:o.options.point_product_sku_id,product_num:o.options.product_num}))},(function(t){i(t)}),(function(o){t.navigateBack()}))):"seckill"===o.options.order_type?(e.num=o.options.num,o._get("plus.seckill.order/buy",{params:JSON.stringify(Object.assign({},e,{seckill_product_id:o.options.seckill_product_id,product_sku_id:o.options.product_sku_id,seckill_product_sku_id:o.options.seckill_product_sku_id,product_num:o.options.product_num}))},(function(t){i(t)}),(function(o){t.navigateBack()}))):"bargain"===o.options.order_type?o._get("plus.bargain.order/buy",{params:JSON.stringify(Object.assign({},e,{bargain_product_id:o.options.bargain_product_id,product_sku_id:o.options.product_sku_id,bargain_product_sku_id:o.options.bargain_product_sku_id,bargain_task_id:o.options.bargain_task_id}))},(function(t){i(t)}),(function(o){t.navigateBack()})):"assemble"===o.options.order_type&&o._get("plus.assemble.order/buy",{params:JSON.stringify(Object.assign({},e,{assemble_product_id:o.options.assemble_product_id,product_sku_id:o.options.product_sku_id,assemble_product_sku_id:o.options.assemble_product_sku_id,product_num:o.options.product_num,assemble_bill_id:o.options.assemble_bill_id}))},(function(t){i(t)}),(function(o){t.navigateBack()}))},toDecimal2:function(t){var o=parseFloat(t);if(isNaN(o))return"0.00";o=Math.round(100*t);var i=Math.round(1e3*t),e=i.toString().split("");e=e[e.length-1],e>=5?o=(o-1)/100:o/=100;var r=o.toString(),n=r.indexOf(".");n<0&&(n=r.length,r+=".");while(r.length<=n+2)r+="0";return r},DistUp:function(t){if(30!=t.orderData.delivery){this.store_id=t.shop_supplier_id,this.chooseSotr=t.shop_supplier_id,this.choose_delivery=t.orderData.delivery;this.chooseSotr;this.getData(),this.deliverySetting=t.orderData.deliverySetting,this.extract_store=t.orderData.extract_store,this.isDist=!0}},closeDistFunc:function(t){this.choose_delivery=t,this.isDist=!1;var o="";this.extract_store.region&&(o=this.extract_store.region.province+this.extract_store.region.city+this.extract_store.region.region+this.extract_store.store_name);var i=this.chooseSotr,e=this.choose_store_id;this.delivery=this.choose_delivery,this.store_id=i,this.store_data[i].store_id=e,this.store_data[i].delivery=this.choose_delivery,this.store_list[i]=o,this.chooseSotr=0,this.getData()},objKeys:function(t,o){if(t)return 1==o?Object.keys(t).length:Object.keys(t)},SubmitOrder:function(){var o=this;if(0!==this.userInfo.pay_password_status)if(o.exist_address){t.showLoading({title:"加载中",mask:!0});var i={pay_type:o.pay_type,room_id:o.room_id,coupon_id:o.coupon_id,is_use_points:o.is_use_points};i=Object.assign(i,{supplier:o.store_data});var e="";"buy"===o.options.order_type&&(e="order.order/buy",i=Object.assign(i,{product_id:o.options.product_id,product_num:o.options.product_num,product_sku_id:o.options.product_sku_id,room_id:o.options.room_id||0}),i=JSON.stringify(i)),"deposit"===o.options.order_type&&(e="plus.advance.Order/frontBuy",i=Object.assign(i,{product_id:o.options.product_id,product_num:o.options.product_num,product_sku_id:o.options.product_sku_id,advance_product_sku_id:o.options.advance_product_sku_id,advance_product_id:o.options.advance_product_id}),i=JSON.stringify(i)),"retainage"===o.options.order_type&&(e="plus.advance.Order/buy",i=Object.assign(i,{order_id:o.options.order_id}),i=JSON.stringify(i)),"cart"===o.options.order_type&&(e="order.order/cart",i=Object.assign(i,{cart_ids:o.options.cart_ids||0,room_id:o.options.room_id||0}),i=JSON.stringify(i)),"points"===o.options.order_type&&(e="plus.points.order/buy",i=Object.assign(i,{point_product_id:o.options.point_product_id,product_sku_id:o.options.product_sku_id,point_product_sku_id:o.options.point_product_sku_id,product_num:o.options.product_num}),i=JSON.stringify(i)),"seckill"===o.options.order_type&&(e="plus.seckill.order/buy",i.num=o.options.num,i=Object.assign(i,{seckill_product_id:o.options.seckill_product_id,product_sku_id:o.options.product_sku_id,seckill_product_sku_id:o.options.seckill_product_sku_id,product_num:o.options.product_num}),i=JSON.stringify(i)),"bargain"===o.options.order_type&&(e="plus.bargain.order/buy",i=Object.assign(i,{bargain_product_id:o.options.bargain_product_id,product_sku_id:o.options.product_sku_id,bargain_product_sku_id:o.options.bargain_product_sku_id,bargain_task_id:o.options.bargain_task_id}),i=JSON.stringify(i)),"assemble"===o.options.order_type&&(e="plus.assemble.order/buy",i=Object.assign(i,{assemble_product_id:o.options.assemble_product_id,product_sku_id:o.options.product_sku_id,assemble_product_sku_id:o.options.assemble_product_sku_id,assemble_bill_id:o.options.assemble_bill_id,product_num:o.options.product_num}),i=JSON.stringify(i));o.subMessage(o.temlIds,(function(){o._post(e,{params:i},(function(t){var i="",e="";"deposit"==o.options.order_type?e="/pages/order/cashier?order_type=50&order_id="+t.data.order_id:"retainage"==o.options.order_type?(i=t.data.order_id,e="/pages/order/cashier?order_type=10&order_id="+i):(i=encodeURIComponent(t.data.order_id.join(",")),e="/pages/order/cashier?order_type=10&order_id="+i),console.log(e),o.gotoPage(e,"reLaunch")}))}))}else t.showToast({title:"请选择配送地址"});else t.showModal({title:"支付密码未设置",confirmText:"前往设置",success:function(o){o.confirm&&t.navigateTo({url:"/pages/user/set/set"})}})}}};o.default=d}).call(this,i("df3c")["default"])},db3f:function(t,o,i){"use strict";var e=i("bfc4"),r=i.n(e);r.a}},[["0251","common/runtime","common/vendor"]]]);