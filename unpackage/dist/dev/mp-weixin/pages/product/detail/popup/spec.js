(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/detail/popup/spec"],{979:function(t,s,o){"use strict";o.r(s);var r=o(980),i=o(982);for(var e in i)["default"].indexOf(e)<0&&function(t){o.d(s,t,(function(){return i[t]}))}(e);o(984);var u,c=o(34),n=Object(c["default"])(i["default"],r["render"],r["staticRenderFns"],!1,null,null,null,!1,r["components"],u);n.options.__file="pages/product/detail/popup/spec.vue",s["default"]=n.exports},980:function(t,s,o){"use strict";o.r(s);var r=o(981);o.d(s,"render",(function(){return r["render"]})),o.d(s,"staticRenderFns",(function(){return r["staticRenderFns"]})),o.d(s,"recyclableRender",(function(){return r["recyclableRender"]})),o.d(s,"components",(function(){return r["components"]}))},981:function(t,s,o){"use strict";var r;o.r(s),o.d(s,"render",(function(){return i})),o.d(s,"staticRenderFns",(function(){return u})),o.d(s,"recyclableRender",(function(){return e})),o.d(s,"components",(function(){return r}));var i=function(){var t=this,s=t.$createElement;t._self._c},e=!1,u=[];i._withStripped=!0},982:function(t,s,o){"use strict";o.r(s);var r=o(983),i=o.n(r);for(var e in r)["default"].indexOf(e)<0&&function(t){o.d(s,t,(function(){return r[t]}))}(e);s["default"]=i.a},983:function(t,s,o){"use strict";(function(t){var r=o(4);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var i=r(o(13)),e={data:function(){return{Visible:!1,form:{detail:{},show_sku:{sku_image:""}},stock:0,selectSpec:"",isOpenSpec:!1,type:"",clock:!1}},props:["isPopup","productModel","room_id"],onLoad:function(){},mounted:function(){},computed:{isadd:function(){return this.form.show_sku.sum>=this.stock||this.form.show_sku.sum>=this.form.detail.limit_num},issub:function(){return this.form.show_sku.sum<=1}},watch:{isPopup:function(t,s){t!=s&&(this.Visible=t,this.isOpenSpec||(this.form=this.productModel,this.isOpenSpec=!0,this.initShowSku()),this.form.type=this.productModel.type)},"form.specData":{handler:function(t,s){var o=this,r="",i="";if(this.isAll=!0,t){for(var e=function(s){null==o.form.productSpecArr[s]?(o.isAll=!1,r+=t.spec_attr[s].group_name+" "):t.spec_attr[s].spec_items.forEach((function(t){o.form.productSpecArr[s]==t.item_id&&(i+='"'+t.spec_value+'" ')}))},u=0;u<t.spec_attr.length;u++)e(u);this.isAll?i="已选: "+i:r="请选择: "+r}this.selectSpec=this.isAll?i:r},deep:!0,immediate:!0}},methods:{initShowSku:function(){this.form.show_sku.sku_image=this.form.detail.image[0].file_path,this.form.show_sku.product_price=this.form.detail.product_price,20==this.form.detail.spec_type&&this.form.detail.product_price!=this.form.detail.product_max_price&&(this.form.show_sku.product_price=this.form.detail.product_price+"-"+this.form.detail.product_max_price),this.form.show_sku.spec_sku_id=0,this.form.show_sku.line_price=this.form.detail.line_price,this.form.show_sku.stock_num=this.form.detail.product_stock,this.form.show_sku.sum=1,this.stock=this.form.detail.product_stock,"advance"==this.form.plus_name&&(this.form.show_sku.product_price=this.form.plus_sku[0].product_price,this.form.show_sku.line_price="",this.form.show_sku.sku_image=this.form.plus_sku[0].productSku.image?this.form.plus_sku[0].productSku.image.file_path:this.form.detail.image[0].file_path,this.form.show_sku.stock_num=this.form.plus_sku[0].advance_stock,this.stock=this.form.plus_sku[0].advance_stock),"seckill"==this.form.plus_name&&(this.form.show_sku.product_price=this.form.plus_sku[0].seckill_price,this.form.show_sku.line_price=this.form.plus_sku[0].product_price,this.form.show_sku.sku_image=this.form.plus_sku[0].productSku.image?this.form.plus_sku[0].productSku.image.file_path:this.form.detail.image[0].file_path,this.form.show_sku.stock_num=this.form.plus_sku[0].seckill_stock,this.stock=this.form.plus_sku[0].seckill_stock)},selectAttr:function(t,s){var o=this,r=o.form.specData.spec_attr[t].spec_items,i=r[s];if(i.checked)i.checked=!1,o.form.productSpecArr[t]=null;else{for(var e=0;e<r.length;e++)r[e].checked=!1;i.checked=!0,o.form.productSpecArr[t]=i.item_id}for(var u=0;u<o.form.productSpecArr.length;u++)if(null==o.form.productSpecArr[u])return void o.initShowSku();o.updateSpecProduct()},updateSpecProduct:function(){var t=this,s=t.form.productSpecArr.join("_"),o=t.form.specData.spec_list;null!=t.form.plus_sku&&(o=t.form.plus_sku);var r=o.find((function(o){return t.form.plus_name?o.productSku.spec_sku_id==s:o.spec_sku_id==s}));if(!r)return t.clock=!0,void t.initShowSku();t.clock=!1,t.form.plus_name&&!r.spec_form&&(r.spec_form=r.productSku),"object"===(0,i.default)(r)&&(t.form.plus_name?(t.stock=r[t.form.plus_name+"_stock"],t.form.show_sku.sum>t.stock&&(t.form.show_sku.sum=t.stock>0?t.stock:1)):(t.stock=r.spec_form.stock_num,t.form.show_sku.sum>t.stock&&(t.form.show_sku.sum=t.stock>0?t.stock:1)),t.form.show_sku.spec_sku_id=s,t.form.show_sku.product_price=r.spec_form.product_price,t.form.show_sku.line_price=r.spec_form.line_price,r.spec_form.image_id>0?t.form.show_sku.sku_image=r.spec_form.image_path:t.form.show_sku.sku_image=t.form.detail.image[0].file_path,t.form.show_sku.stock_num=r.spec_form.stock_num,t.form.plus_name&&(t.form.show_sku.product_price=r.product_price,"seckill"==t.form.plus_name&&(t.form.show_sku.product_price=r.seckill_price),t.form.show_sku.stock_num=r[t.form.plus_name+"_stock"],t.form.show_sku.line_price="",t.form.show_sku.sku_image=r.spec_form.image?r.spec_form.image.file_path:t.form.detail.image[0].file_path,t.form.show_sku.advance_product_id=r.spec_form.image?r.spec_form.image.file_path:t.form.detail.image[0].file_path))},closePopup:function(){this.$emit("close",this.form.specData,null)},confirmFunc:function(){if(null!=this.form.specData)for(var s=0;s<this.form.productSpecArr.length;s++)if(null==this.form.productSpecArr[s])return void t.showToast({title:"请选择规格",icon:"none",duration:2e3});"card"==this.form.type?this.addCart():this.createdOrder()},addCart:function(){var s=this,o=s.form.detail.product_id,r=s.form.show_sku.sum,i=s.form.show_sku.spec_sku_id;if(20==s.form.detail.spec_type&&0==i)return t.showToast({title:"请选择属性",icon:"none",duration:2e3}),!1;s._post("order.cart/add",{product_id:o,total_num:r,spec_sku_id:i},(function(o){t.showToast({title:o.msg,duration:2e3}),s.$emit("close",null,o.data.cart_total_num)}))},createdOrder:function(){var t=this.form.detail.product_id,s=this.form.show_sku.sum,o=this.form.show_sku.spec_sku_id,r="";0!=this.room_id&""!=this.room_id&&(r="&room_id="+this.room_id),console.log(r);var i="/pages/order/confirm-order?product_id="+t+"&product_num="+s+"&product_sku_id="+o+"&order_type=buy"+r;if("deposit"==this.form.type){if("advance"==this.form.plus_name){var e=this.form.detail.advance.sku.find((function(t){return t.productSku.spec_sku_id==o}));i="/pages/order/confirm-order?product_id="+t+"&product_num="+s+"&product_sku_id="+o+"&advance_product_sku_id="+e.advance_product_sku_id+"&advance_product_id="+e.advance_product_id+"&order_type=deposit"}if("seckill"==this.form.plus_name){var u=this.form.detail.secKill.seckillSku.find((function(t){return t.productSku.spec_sku_id==o}));i="/pages/order/confirm-order?seckill_product_id="+u.seckill_product_id+"&product_num="+s+"&product_sku_id="+u.productSku.spec_sku_id+"&seckill_product_sku_id="+u.seckill_product_sku_id+"&order_type=seckill"}}this.gotoPage(i)},add:function(){if(!(this.stock<=0))return this.form.show_sku.sum>=this.stock?(t.showToast({title:"数量超过了库存",icon:"none",duration:2e3}),!1):this.form.detail.limit_num>0&&this.form.show_sku.sum>=this.form.detail.limit_num?(t.showToast({title:"数量超过了限购数量",icon:"none",duration:2e3}),!1):void this.form.show_sku.sum++},sub:function(){if(!(this.stock<=0))return this.form.show_sku.sum<2?(t.showToast({title:"商品数量至少为1",icon:"none",duration:2e3}),!1):void this.form.show_sku.sum--}}};s.default=e}).call(this,o(2)["default"])},984:function(t,s,o){"use strict";o.r(s);var r=o(985),i=o.n(r);for(var e in r)["default"].indexOf(e)<0&&function(t){o.d(s,t,(function(){return r[t]}))}(e);s["default"]=i.a},985:function(t,s,o){}}]);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/pages/product/detail/popup/spec.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/product/detail/popup/spec-create-component',
    {
        'pages/product/detail/popup/spec-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('2')['createComponent'](__webpack_require__(979))
        })
    },
    [['pages/product/detail/popup/spec-create-component']]
]);
