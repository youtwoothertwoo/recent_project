(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/set/set"],{515:function(e,n,t){"use strict";(function(e,n){var o=t(4);t(26);o(t(25));var i=o(t(516));e.__webpack_require_UNI_MP_PLUGIN__=t,n(i.default)}).call(this,t(1)["default"],t(2)["createPage"])},516:function(e,n,t){"use strict";t.r(n);var o=t(517),i=t(519);for(var s in i)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(s);t(521);var a,u=t(34),r=Object(u["default"])(i["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],a);r.options.__file="pages/user/set/set.vue",n["default"]=r.exports},517:function(e,n,t){"use strict";t.r(n);var o=t(518);t.d(n,"render",(function(){return o["render"]})),t.d(n,"staticRenderFns",(function(){return o["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return o["recyclableRender"]})),t.d(n,"components",(function(){return o["components"]}))},518:function(e,n,t){"use strict";var o;t.r(n),t.d(n,"render",(function(){return i})),t.d(n,"staticRenderFns",(function(){return a})),t.d(n,"recyclableRender",(function(){return s})),t.d(n,"components",(function(){return o}));var i=function(){var e=this,n=e.$createElement,t=(e._self._c,e.theme()||""),o=e.theme();e.$mp.data=Object.assign({},{$root:{m0:t,m1:o}})},s=!1,a=[];i._withStripped=!0},519:function(e,n,t){"use strict";t.r(n);var o=t(520),i=t.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(s);n["default"]=i.a},520:function(e,n,t){"use strict";(function(e){var o=t(4);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t(13)),s=function(){t.e("components/upload/uploadOne").then(function(){return resolve(t(1120))}.bind(null,t)).catch(t.oe)},a=function(){t.e("components/uni-popup").then(function(){return resolve(t(115))}.bind(null,t)).catch(t.oe)},u={components:{Upload:s,Popup:a},data:function(){return{userInfo:{},isUpload:!1,isPopup:!1,isOpen:!1,isShow:!1,newName:"",newPsd:"",oldPsd:"",confirmPsd:"",hdPsd:"",type:"",version_no:"",imageList:[],max_length:6}},onShow:function(){this.getData()},methods:{onChooseAvatar:function(e){var n=this;console.log(e),n.uploadFile([e.detail.avatarUrl])},getData:function(){var n=this;e.showLoading({title:"加载中"}),n._get("user.index/setting",{},(function(t){n.userInfo=t.data.userInfo,e.hideLoading()}))},gotoBind:function(){this.gotoPage("/pages/user/modify-phone/modify-phone")},logout:function(){e.removeStorageSync("token"),e.removeStorageSync("user_id"),this.gotoPage("/pages/index/index")},changeName:function(e){var n=this;"mobile"==e&&(n.oldmobile=n.userInfo.mobile),n.type=e,n.newName=n.userInfo[e],n.isPopup=!0},hidePopupFunc:function(){this.newName="",this.isShow=!1},changeinput:function(e){this.newName=e.target.value},clearName:function(){this.newName=""},clearPsd:function(){this.newPsd=""},clearHdPsd:function(){this.hdPsd=""},subName:function(e){var n=this;n.loading||(n.newName=e.detail.value.newName,n.userInfo[n.type]=this.newName,n.update())},changeAvatarUrl:function(){var e=this;e.isUpload=!0},uploadFile:function(n){var t=this,o=0,s=n.length,a={token:e.getStorageSync("token"),app_id:t.getAppId()};e.showLoading({title:"图片上传中"}),n.forEach((function(n,u){e.uploadFile({url:t.websiteUrl+"/index.php?s=/api/file.upload/image",filePath:n,name:"iFile",formData:a,success:function(e){var n="object"===(0,i.default)(e.data)?e.data:JSON.parse(e.data);1===n.code?t.imageList.push(n.data):t.showError(n.msg)},complete:function(){o++,s===o&&(e.hideLoading(),t.getImgsFunc(t.imageList))}})}))},getImgsFunc:function(e){if(e&&"undefined"!=typeof e){var n=this;n.userInfo.avatarUrl=e[0].file_path,n.update(),n.isUpload=!1}},update:function(){var n=this;if(!n.loading){e.showLoading({title:"加载中"});var t=n.userInfo;n.loading=!0,n._post("user.user/updateInfo",t,(function(t){n.showSuccess("修改成功",(function(){n.loading=!1,n.isPopup=!1,e.hideLoading(),n.getData()}),(function(t){e.hideLoading(),n.loading=!1,n.isPopup=!1}))}))}},deleteAccount:function(){var n=this;e.showModal({title:"提示",content:"是否确认删除账号？删除后您将无法用此账号登录，此账户下的数据也将删除",success:function(t){t.confirm&&n._post("user.user/deleteAccount",{},(function(t){n.showSuccess("删除成功",(function(){e.removeStorageSync("token"),e.removeStorageSync("user_id"),n.gotoPage("/pages/index/index")}))}),!1,(function(){e.hideLoading()}))}})},setpass:function(){this.isOpen=!0},hedui:function(){this.isShow=!0},handleClose:function(){this.newPsd="",this.oldPsd="",this.confirmPsd="",this.isOpen=!1},heduiClose:function(){this.hdPsd="",this.isShow=!1},changePsd:function(e){this.newPsd=e.detail.value},changeOldPsd:function(e){this.oldPsd=e.detail.value},changeConfirmPsd:function(e){this.confirmPsd=e.detail.value},heduiPsd:function(e){this.hdPsd=e.detail.value},getPrevRoute:function(){var e=getCurrentPages();if(e.length<2)return null;var n=e[e.length-2];return{route:n.route||n.__route__,options:n.options||{}}},subPsd:function(){var n=this;if(""!=n.newPsd)if(n.newPsd.length<n.max_length)n.showError("请输入"+n.max_length+"位密码");else if(n.newPsd==n.confirmPsd)if(e.showLoading({title:"加载中"}),0===this.userInfo.pay_password_status){var t={pay_password:this.newPsd};n._post("user.user/setPayPassword",t,(function(t){n.showSuccess("设置成功",(function(){n.loading=!1,n.isOpen=!1,e.hideLoading(),n.userInfo.pay_password_status=1,n.getData();var t=n.getPrevRoute();t&&"pages/order/cashier"===t.route&&e.navigateBack()}),(function(t){e.hideLoading(),n.loading=!1,n.isPopup=!1}))}))}else{var o={pay_password_new:this.newPsd,pay_password_old:this.oldPsd};n._post("user.user/updatePayPassword",o,(function(t){n.showSuccess("修改成功",(function(){n.loading=!1,n.isOpen=!1,e.hideLoading(),n.getData()}),(function(t){e.hideLoading(),n.loading=!1,n.isOpen=!1}))}))}else n.showError("两次输入的密码不一致");else n.showError("请输入密码")}}};n.default=u}).call(this,t(2)["default"])},521:function(e,n,t){"use strict";t.r(n);var o=t(522),i=t.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(s);n["default"]=i.a},522:function(e,n,t){}},[[515,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/user/set/set.js.map